# üõ°Ô∏è HoneyPot Security Suite ‚Äì Projet Annuel ESGI

Bienvenue ! Ce projet propose une **infrastructure de s√©curit√© compl√®te** incluant un gestionnaire de mots de passe s√©curis√© avec authentification √† deux facteurs (MFA), coupl√© √† un **syst√®me de monitoring et d√©tection d'intrusion** professionnel.

---

## üöÄ Vue d'ensemble du projet

### üéØ **Objectifs p√©dagogiques**
Ce projet ESGI d√©montre la mise en ≈ìuvre d'une architecture de s√©curit√© moderne comprenant :
- **D√©veloppement s√©curis√©** : Application web avec MFA et chiffrement
- **D√©tection d'intrusion** : Monitoring r√©seau et syst√®me en temps r√©el  
- **Analyse forensique** : Centralisation et visualisation des logs
- **Infrastructure as Code** : D√©ploiement automatis√© avec Docker

### üèóÔ∏è **Architecture technique**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   FRONTEND      ‚îÇ    ‚îÇ    BACKEND      ‚îÇ    ‚îÇ   DATABASE      ‚îÇ
‚îÇ   (NGINX/SSL)   ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (FastAPI)     ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ  (PostgreSQL)   ‚îÇ
‚îÇ   Port 80/443   ‚îÇ    ‚îÇ   Port 8000     ‚îÇ    ‚îÇ   Port 5432     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                       ‚îÇ                       ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ              STACK DE S√âCURIT√â                            ‚îÇ
    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    ‚îÇ   SNORT IDS     ‚îÇ   WAZUH HIDS    ‚îÇ    ELK STACK        ‚îÇ
    ‚îÇ (R√©seau/Port)   ‚îÇ (Fichiers/Sys)  ‚îÇ (Logs/Analytics)    ‚îÇ
    ‚îÇ   Port 1514     ‚îÇ   Port 1515     ‚îÇ Elasticsearch:9200  ‚îÇ
    ‚îÇ                 ‚îÇ   Port 55000    ‚îÇ Logstash:5044       ‚îÇ
    ‚îÇ                 ‚îÇ                 ‚îÇ Kibana:5601         ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üõ°Ô∏è **Composants de s√©curit√©**

#### **Application principale**
- **Frontend** : Interface web s√©curis√©e (HTTPS, certificats SSL)
- **Backend** : API FastAPI avec authentification MFA/2FA
- **Base de donn√©es** : PostgreSQL avec chiffrement des secrets
- **Administration** : pgAdmin pour la gestion base de donn√©es

#### **Syst√®me de d√©tection d'intrusion (IDS/HIDS)**
- **Snort IDS** : D√©tection d'intrusion r√©seau en temps r√©el
- **Wazuh HIDS** : Surveillance d'int√©grit√© des fichiers syst√®me
- **R√®gles personnalis√©es** : D√©tection d'attaques SSH, web, scan de ports

#### **Stack d'analyse et monitoring**
- **Elasticsearch** : Moteur de recherche et indexation des logs
- **Logstash** : Pipeline de traitement et enrichissement des logs
- **Kibana** : Interface de visualisation et dashboard de s√©curit√©

### ‚ú® **Fonctionnalit√©s**

#### **Gestionnaire de mots de passe**
- Cr√©er un compte personnel s√©curis√©
- Activer l'authentification √† deux facteurs (MFA/2FA) avec TOTP
- Ajouter, lister et supprimer vos mots de passe pour diff√©rents sites
- Interface web moderne et intuitive

#### **Monitoring de s√©curit√©**
- D√©tection en temps r√©el des tentatives d'intrusion
- Surveillance de l'int√©grit√© des fichiers critiques
- Alertes automatiques sur activit√©s suspectes
- Tableaux de bord de s√©curit√© avec m√©triques
- Analyse forensique des incidents

---

## üõ†Ô∏è Installation et configuration

### 1. Pr√©requis

- [Docker](https://www.docker.com/products/docker-desktop)
- [Docker Compose](https://docs.docker.com/compose/)
- [Python 3](https://www.python.org/) (pour le script de configuration)
- [Git](https://git-scm.com/) pour cloner le d√©p√¥t

### 2. Cloner le projet

```bash
git clone https://github.com/BelmonteLucas/Projet_Annuel.git
cd Projet_Annuel
```

### 3. Configuration de l'environnement

#### a. Installer les d√©pendances de d√©veloppement

```bash
pip install -r requirements-dev.txt
```

#### b. Lancer le script de configuration

```bash
python setup_dev_environment.py
```

Ce script va :
- Cr√©er le r√©pertoire `secrets/` si n√©cessaire
- G√©n√©rer une cl√© de chiffrement MFA unique (`secrets/mfa_encryption_key.txt`)
- Configurer l'environnement de d√©veloppement local

#### c. Configurer le mot de passe de la base de donn√©es

Cr√©ez le fichier `secrets/db_password.txt` avec votre mot de passe :

```bash
echo "votre_mot_de_passe_securise" > secrets/db_password.txt
```

### 4. D√©ploiement avec Docker

```bash
# Construction et lancement de toute l'infrastructure
docker compose up -d --build

# V√©rifier que tous les services sont op√©rationnels
docker compose ps
```

L'option `--build` est recommand√©e la premi√®re fois ou apr√®s des modifications.

---

## üåê Acc√®s aux services

### **üñ•Ô∏è Applications principales**

| Service | URL | Description |
|---------|-----|-------------|
| **Frontend** | [https://localhost/](https://localhost/) | Interface utilisateur principale (HTTPS) |
| **API Backend** | [http://localhost:8000](http://localhost:8000) | API FastAPI avec documentation |
| **Swagger Docs** | [http://localhost:8000/docs](http://localhost:8000/docs) | Documentation interactive de l'API |

### **üîß Administration**

| Service | URL | Identifiants | Description |
|---------|-----|--------------|-------------|
| **pgAdmin** | [http://localhost:5050](http://localhost:5050) | `admin@admin.com` / `admin` | Interface d'administration PostgreSQL |
| **Kibana** | [http://localhost:5601](http://localhost:5601) | Acc√®s direct | Tableaux de bord de s√©curit√© |

### **üõ°Ô∏è Monitoring de s√©curit√©**

| Service | Port | Description |
|---------|------|-------------|
| **Snort IDS** | `1514/udp` | Collecte des logs syslog |
| **Wazuh API** | `55000` | API de gestion Wazuh |
| **Elasticsearch** | `9200` | Moteur de recherche des logs |

---

## üìä Surveillance et monitoring

### **üîç Commandes utiles pour v√©rifier l'√©tat**

```bash
# Afficher le statut de tous les services avec format tableau
docker compose ps --format "table {{.Name}}\t{{.Status}}\t{{.Ports}}"

# Alternative : format personnalis√© avec services
docker compose ps --format "table {{.Service}}\t{{.Name}}\t{{.Status}}"

# Affichage compact avec statut uniquement
docker ps --format "table {{.Names}}\t{{.Status}}" --filter "label=com.docker.compose.project=projet_annuel"

# Affichage d√©taill√© avec ports et sant√©
docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}\t{{.Size}}"

# V√©rifier les logs de Snort IDS
docker logs snort_ids --tail 20

# Consulter les alertes de s√©curit√© en temps r√©el
docker exec snort_ids tail -f /var/log/snort/alert

# V√©rifier l'√©tat de Wazuh
docker logs wazuh_manager --tail 10

# √âtat de sant√© d'Elasticsearch
curl -s http://localhost:9200/_cluster/health | jq

# Surveillance en temps r√©el des logs
docker compose logs -f --tail=10
```

#### **üìä Commandes de monitoring avanc√©**

```bash
# Statistiques d'utilisation des ressources
docker stats --format "table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}\t{{.NetIO}}"

# V√©rifier les healthchecks
docker inspect --format='{{.State.Health.Status}}' elasticsearch
docker inspect --format='{{.State.Health.Status}}' postgres_db_service

# Logs filtr√©s par niveau d'erreur
docker compose logs | grep -i error

# √âtat des volumes Docker
docker volume ls | grep projet_annuel
docker system df
```

### **üìà M√©triques de s√©curit√©**

- **Snort IDS** : Capture et analyse le trafic r√©seau en temps r√©el
- **Wazuh HIDS** : Surveille l'int√©grit√© des fichiers backend
- **ELK Stack** : Centralise tous les logs pour analyse et visualisation
- **Healthchecks** : Garantissent la disponibilit√© des services critiques

---

## üîí S√©curit√© et bonnes pratiques

### **üîê Gestion des secrets**

- **Mots de passe** : Stock√©s dans `secrets/db_password.txt` (gitignore)
- **Cl√©s MFA** : Chiffr√©es avec `secrets/mfa_encryption_key.txt`
- **Certificats SSL** : `nginx.crt` et `nginx.key` pour HTTPS
- **Isolation r√©seau** : R√©seau Docker interne isol√©

### **üõ°Ô∏è Fonctionnalit√©s MFA**

1. **Activation du MFA** : Interface utilisateur avec QR code
2. **Authentification TOTP** : Compatible Google Authenticator, Authy
3. **Stockage s√©curis√©** : Secrets MFA chiffr√©s en base
4. **V√©rification obligatoire** : Code OTP requis pour la connexion

### **‚ö†Ô∏è Alertes de s√©curit√© configur√©es**

- Tentatives de brute force SSH
- Scans de ports suspects  
- Acc√®s non autoris√©s aux fichiers sensibles
- Trafic r√©seau anormal
- Connexions √† la base de donn√©es

---

## üß™ Tests et validation

### **‚úÖ V√©rifier l'installation**

```bash
# Tous les conteneurs doivent √™tre "Up"
docker ps

# Tester l'acc√®s √† l'interface web
curl -k https://localhost/

# V√©rifier l'API
curl http://localhost:8000/

# Tester Elasticsearch
curl http://localhost:9200/_cluster/health
```

### **üéØ Sc√©narios de test**

1. **Cr√©er un compte utilisateur** sur l'interface web
2. **Activer le MFA** et scanner le QR code
3. **Se d√©connecter et reconnecter** avec le code OTP
4. **Ajouter/supprimer des mots de passe**
5. **G√©n√©rer du trafic** pour tester Snort
6. **Consulter les tableaux de bord** Kibana

---

## üßë‚Äçüíª D√©veloppement

### **üîß Structure du projet**

```
Projet_Annuel/
‚îú‚îÄ‚îÄ docker-compose.yml          # Orchestration compl√®te
‚îú‚îÄ‚îÄ nginx.conf                  # Configuration NGINX/SSL
‚îú‚îÄ‚îÄ setup_dev_environment.py    # Script d'initialisation
‚îú‚îÄ‚îÄ backend/                    # API FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ main.py                # Point d'entr√©e de l'API
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # Mod√®les de donn√©es
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt       # D√©pendances Python
‚îú‚îÄ‚îÄ frontend/                   # Interface web
‚îÇ   ‚îú‚îÄ‚îÄ index.html             # Page principale
‚îÇ   ‚îú‚îÄ‚îÄ app.js                 # Logique JavaScript
‚îÇ   ‚îî‚îÄ‚îÄ style.css              # Styles CSS
‚îú‚îÄ‚îÄ snort/                      # Configuration Snort IDS
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile             # Image Snort personnalis√©e
‚îÇ   ‚îú‚îÄ‚îÄ snort.conf             # Configuration Snort
‚îÇ   ‚îú‚îÄ‚îÄ entrypoint.sh          # Script de d√©marrage
‚îÇ   ‚îî‚îÄ‚îÄ rules/                 # R√®gles de d√©tection
‚îú‚îÄ‚îÄ elk/                        # Configuration ELK Stack
‚îÇ   ‚îú‚îÄ‚îÄ elasticsearch/         # Config Elasticsearch
‚îÇ   ‚îú‚îÄ‚îÄ logstash/              # Pipelines Logstash
‚îÇ   ‚îî‚îÄ‚îÄ kibana/                # Dashboards Kibana
‚îî‚îÄ‚îÄ secrets/                    # Fichiers sensibles (gitignore)
    ‚îú‚îÄ‚îÄ db_password.txt        # Mot de passe PostgreSQL
    ‚îî‚îÄ‚îÄ mfa_encryption_key.txt # Cl√© de chiffrement MFA
```

### **üîÑ Workflow de d√©veloppement**

```bash
# D√©veloppement local
python setup_dev_environment.py

# Relancer apr√®s modifications
docker compose down
docker compose up -d --build

# Logs en temps r√©el
docker compose logs -f [service_name]

# Acc√®s aux conteneurs
docker exec -it [container_name] /bin/bash
```

---

## üìö Documentation technique

### **üîó Technologies utilis√©es**

- **Frontend** : HTML5, CSS3, JavaScript ES6
- **Backend** : FastAPI, SQLAlchemy, Uvicorn
- **Base de donn√©es** : PostgreSQL 13
- **S√©curit√©** : pyOTP, cryptography, passlib
- **Infrastructure** : Docker, Docker Compose, NGINX
- **Monitoring** : Snort 2.x, Wazuh 4.7.5, ELK Stack 7.17.9

### **üåê APIs et endpoints**

Consultez la documentation Swagger √† l'adresse : [http://localhost:8000/docs](http://localhost:8000/docs)

### **üîß Configuration avanc√©e**

Pour une configuration en production, consultez :
- Les fichiers de configuration dans `elk/`
- Les r√®gles Snort dans `snort/rules/`
- La configuration Wazuh pour la surveillance des fichiers

---

## üÜò Support et d√©pannage

### **‚ùå Probl√®mes courants**

| Probl√®me | Solution |
|----------|----------|
| Port d√©j√† utilis√© | `docker compose down` puis changer les ports |
| Permissions refus√©es | V√©rifier les fichiers dans `secrets/` |
| Services non healthy | `docker compose logs [service]` |
| Erreur SSL/TLS | R√©g√©n√©rer les certificats NGINX |

### **üîç Debugging**

```bash
# Logs d√©taill√©s d'un service
docker compose logs --details [service_name]

# √âtat des conteneurs
docker stats

# Inspection des r√©seaux
docker network ls
docker network inspect [network_name]

# Volumes Docker
docker volume ls
docker volume inspect [volume_name]
```

### **üÜò Support**

- **Issues GitHub** : [https://github.com/BelmonteLucas/Projet_Annuel/issues](https://github.com/BelmonteLucas/Projet_Annuel/issues)
- **Documentation** : Ce README et les commentaires dans le code
- **Logs** : Consultez toujours les logs Docker en cas de probl√®me

---

## üìÑ Licence et contributions

Ce projet est d√©velopp√© dans le cadre d'un **projet annuel ESGI** √† des fins p√©dagogiques.

- **Auteur** : Lucas Belmonte
- **Formation** : ESGI - Expert en S√©curit√© Informatique
- **Ann√©e** : 2024-2025

Les contributions sont les bienvenues via des Pull Requests sur GitHub.

---

*üõ°Ô∏è S√©curit√© avant tout - Ce projet d√©montre l'impl√©mentation d'une infrastructure de s√©curit√© compl√®te avec d√©tection d'intrusion et monitoring en temps r√©el.*
